"------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
"------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
"------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[REPORT - ZRLA_ATRIB_EQUIP]


*&---------------------------------------------------------------------*
*& Report ZRLA_ATRIB_EQUIP
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT ZRLA_ATRIB_EQUIP.

*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*&-SCREEN100-----------------------------------------------------------*

"variavel de funcao de sistema
data: okcode100 type sy-ucomm.

"campo de chave de identificacao do colaborador.
data: in_employee type znn_atrib_equi-id_employee.

"campos de entrada para screen100 em formato de lisbox.
data: in_pc type znn_equipamentos-descricao,
      in_telem type znn_equipamentos-descricao.

"modulo pbo
INCLUDE zrla_atrib_equip_status_010o01.
"modulo pai
INCLUDE zrla_atrib_equip_user_commai01.

*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*

"------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
"------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
"------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[PBO]

*----------------------------------------------------------------------*
***INCLUDE ZRLA_ATRIB_EQUIP_STATUS_010O01.
*----------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*& Module STATUS_0100 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
module status_0100 output.
  set pf-status 'SBX CONSULTING'.
* SET TITLEBAR 'xxx'.

  "tabelas internas com campo chave e texto relacionado
  data: values_list_equi type vrm_values,
        values_list_telf type vrm_values.
  "estruturas da tabela
  data: value_list_equi like line of values_list_equi,
        value_list_telf like line of values_list_equi.

endmodule.
*&---------------------------------------------------------------------*
*& Module EXIT_BUTTON OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
module exit_button output.
* SET PF-STATUS 'xxxxxxxx'.
* SET TITLEBAR 'xxx'.

  case okcode100.
    when 'FCT_SAIR'.
      leave program.
  endcase.

endmodule.
*&---------------------------------------------------------------------*
*& Module LISTAR_BUTTON OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
module listar_button output.
* SET PF-STATUS 'xxxxxxxx'.
* SET TITLEBAR 'xxx'.

  case okcode100.
    when 'FCT_EXIBIR'.
      include z_fill_data100.
      include z_fill_listboxes0100.
  endcase.

endmodule.
*&---------------------------------------------------------------------*
*& Module GUARDAR_BUTTON OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
module guardar_button output.
* SET PF-STATUS 'xxxxxxxx'.
* SET TITLEBAR 'xxx'.

  case okcode100.
    when 'FCT_GUARDAR'.
      zcl_rla_equipamento=>insert_equip(
        exporting
          id_employee = in_employee           " Colaborador
          id_ltp      = in_pc                 " ID do Portátil
          id_tlm      = in_telem              " ID do Telemóvel
      ).

    endcase.
endmodule.
"------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
"------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
"------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[Z_FILL_DATA100]

*&---------------------------------------------------------------------*
*& Include          Z_FILL_DATA100
*&---------------------------------------------------------------------*
  "preenche as tabelas com os telemóveis e portáteis relacionadados aos seus repectivos campos e filtros
  select id_equipamento descricao from znn_equipamentos into (value_list_equi-key, value_list_equi-text) where tipo_equip_id eq 'LPT'.
    append value_list_equi to values_list_equi.
  endselect.
  select id_equipamento descricao from znn_equipamentos into (value_list_telf-key, value_list_telf-text) where tipo_equip_id eq 'TLM'.
    append value_list_telf to values_list_telf.
  endselect.

"------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
"------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
"------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[Z_FILL_LISTBOXES0100]

*&---------------------------------------------------------------------*
*& Include          Z_FILL_LISTBOXES0100
*&---------------------------------------------------------------------*
"chama duas vezes a funcao para preencher as listboxes da screen100

  "listboxes para portáteis
  call function 'VRM_SET_VALUES'
    exporting
      id              = 'IN_PC'
      values          = values_list_equi
    exceptions
      id_illegal_name = 1
      others          = 2.
  "listboxes para telemóveis
  call function 'VRM_SET_VALUES'
    exporting
      id              = 'IN_TELEM'
      values          = values_list_telf
    exceptions
      id_illegal_name = 1
      others          = 2.
  if sy-subrc ne 0.
    message: 'Impossível inserir dados à listabox' type 'E'.
  endif.

"------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
"------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
"------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[PAI]

*----------------------------------------------------------------------*
***INCLUDE ZRLA_ATRIB_EQUIP_USER_COMMAI01.
*----------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0100  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
module user_command_0100 input.
  "saída da transacao
  case okcode100.
    when 'BACK'.
      leave to screen 0.
    when 'CANCEL'.
      leave to screen 0.
    when 'EXIT'.
      leave to screen 0.
      set screen 0.
      leave screen.
  endcase.
endmodule.
